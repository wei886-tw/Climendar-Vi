import{_ as L,c as V,a,b as n,w as s,f as C,r as t,e as d,u as D,g as v,h as x,d as r,i as A,j as G,o as z,t as k}from"./index-B2x7OsNE.js";import{g as F}from"./googleCalendar-BQIMh3Gz.js";const S={name:"LogIn",setup(){const f=G(),e=D(),u=v(null),o=v(!1),c=v(!1),m=x({email:"",password:"",remember:!1});return{loginForm:u,loginData:m,rules:{email:[{required:!0,message:"請輸入電子郵件",trigger:"blur"},{type:"email",message:"請輸入有效的電子郵件格式",trigger:"blur"}],password:[{required:!0,message:"請輸入密碼",trigger:"blur"},{min:6,message:"密碼長度至少6個字符",trigger:"blur"}]},loading:o,googleLoading:c,handleLogin:async()=>{if(u.value)try{if(!await u.value.validate())return;o.value=!0,await new Promise(y=>setTimeout(y,1500));const i={id:1,email:m.email,name:m.email.split("@")[0]},b="mock-jwt-token-"+Date.now();e.login(i,b),r.success("登入成功！"),f.push("/")}catch{r.error("登入失敗，請檢查您的帳號密碼")}finally{o.value=!1}},handleGoogleLogin:async()=>{try{c.value=!0;const l=await A.signIn();F.setAccessToken(l.accessToken),e.login(l.user,l.accessToken),r.success("Google 登入成功！"),f.push("/")}catch(l){console.error("Google 登入失敗:",l),l.message&&l.message.includes("客戶端 ID 未設定")?r.error("Google OAuth 未設定，請聯繫管理員"):l.type==="popup_closed"?r.warning("登入已取消"):l.message==="access_denied"?r.error("登入權限被拒絕"):r.error("Google 登入失敗，請重試")}finally{c.value=!1}},handleForgotPassword:()=>{r.info("忘記密碼功能開發中...")},handleRegister:()=>{r.info("註冊功能開發中...")}}}},B={class:"login-container"},M={class:"login-card"},I={class:"login-footer"};function T(f,e,u,o,c,m){const p=t("el-input"),g=t("el-form-item"),h=t("el-checkbox"),_=t("el-button"),w=t("el-form"),l=t("el-link");return z(),V("div",B,[a("div",M,[e[8]||(e[8]=a("div",{class:"login-header"},[a("h2",null,"登入"),a("p",null,"登入您的帳戶以使用日曆功能")],-1)),n(w,{ref:"loginForm",model:o.loginData,rules:o.rules,class:"login-form",onSubmit:C(o.handleLogin,["prevent"])},{default:s(()=>[n(g,{prop:"email"},{default:s(()=>[n(p,{modelValue:o.loginData.email,"onUpdate:modelValue":e[0]||(e[0]=i=>o.loginData.email=i),placeholder:"請輸入電子郵件","prefix-icon":"User",size:"large",clearable:""},null,8,["modelValue"])]),_:1}),n(g,{prop:"password"},{default:s(()=>[n(p,{modelValue:o.loginData.password,"onUpdate:modelValue":e[1]||(e[1]=i=>o.loginData.password=i),type:"password",placeholder:"請輸入密碼","prefix-icon":"Lock",size:"large","show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),n(g,null,{default:s(()=>[n(h,{modelValue:o.loginData.remember,"onUpdate:modelValue":e[2]||(e[2]=i=>o.loginData.remember=i)},{default:s(()=>e[3]||(e[3]=[d("記住我")])),_:1,__:[3]},8,["modelValue"])]),_:1}),n(g,null,{default:s(()=>[n(_,{type:"primary",size:"large",class:"login-button",loading:o.loading,onClick:o.handleLogin},{default:s(()=>[d(k(o.loading?"登入中...":"登入"),1)]),_:1},8,["loading","onClick"])]),_:1})]),_:1},8,["model","rules","onSubmit"]),e[9]||(e[9]=a("div",{class:"divider"},[a("span",null,"或")],-1)),n(_,{class:"google-login-button",size:"large",loading:o.googleLoading,onClick:o.handleGoogleLogin},{icon:s(()=>e[4]||(e[4]=[a("svg",{width:"18",height:"18",viewBox:"0 0 18 18"},[a("path",{fill:"#4285F4",d:"M16.51 8H8.98v3h4.3c-.18 1-.74 1.48-1.6 2.04v2.01h2.6a7.8 7.8 0 0 0 2.38-5.88c0-.57-.05-.66-.15-1.18z"}),a("path",{fill:"#34A853",d:"M8.98 17c2.16 0 3.97-.72 5.3-1.94l-2.6-2.04a4.8 4.8 0 0 1-7.18-2.53H1.83v2.07A8 8 0 0 0 8.98 17z"}),a("path",{fill:"#FBBC05",d:"M4.5 10.49a4.8 4.8 0 0 1 0-3.07V5.35H1.83A8 8 0 0 0 1.83 12.56z"}),a("path",{fill:"#EA4335",d:"M8.98 4.72c1.16 0 2.23.4 3.06 1.2l2.3-2.3A8 8 0 0 0 1.83 5.35L4.5 7.42a4.77 4.77 0 0 1 4.48-2.7z"})],-1)])),default:s(()=>[d(" "+k(o.googleLoading?"Google 登入中...":"使用 Google 登入"),1)]),_:1},8,["loading","onClick"]),a("div",I,[a("p",null,[n(l,{type:"primary",onClick:o.handleForgotPassword},{default:s(()=>e[5]||(e[5]=[d("忘記密碼？")])),_:1,__:[5]},8,["onClick"])]),a("p",null,[e[7]||(e[7]=d(" 還沒有帳戶？ ")),n(l,{type:"primary",onClick:o.handleRegister},{default:s(()=>e[6]||(e[6]=[d("立即註冊")])),_:1,__:[6]},8,["onClick"])])])])])}const U=L(S,[["render",T],["__scopeId","data-v-23f2a703"]]);export{U as default};
